# å‚è€ƒèµ„æ–™

æœ¬èŠ‚æä¾› TrueWord Node çš„æŠ€æœ¯å‚è€ƒæ–‡æ¡£ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶æ ¼å¼ã€è·¯ç”±è¡¨è®¾è®¡ã€æ ¸å¿ƒæœºåˆ¶è¯´æ˜å’Œæ•…éšœæ’æŸ¥æŒ‡å—ã€‚

## ğŸ“š æ–‡æ¡£åˆ—è¡¨

### [é…ç½®æ–‡ä»¶è¯¦è§£](config-files.md)
è¯¦ç»†è¯´æ˜æ‰€æœ‰é…ç½®æ–‡ä»¶çš„æ ¼å¼å’Œå­—æ®µå«ä¹‰ã€‚

**æ¶µç›–å†…å®¹**ï¼š
- å…¨å±€é…ç½®æ–‡ä»¶ï¼ˆ`/etc/trueword_node/config.yaml`ï¼‰
- ç‰©ç†æ¥å£é…ç½®ï¼ˆ`/etc/trueword_node/interfaces/physical.yaml`ï¼‰
- éš§é“é…ç½®æ–‡ä»¶ï¼ˆ`/etc/trueword_node/tunnels/*.yaml`ï¼‰
- ç­–ç•¥ç»„é…ç½®æ–‡ä»¶ï¼ˆ`/etc/trueword_node/policies/*.json`ï¼‰
- è¿è¡Œæ—¶æ•°æ®ï¼ˆ`/var/lib/trueword_node/`ï¼‰

**é€‚ç”¨å¯¹è±¡**ï¼š
- éœ€è¦æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶çš„ç”¨æˆ·
- éœ€è¦æ‰¹é‡å¯¼å…¥/å¯¼å‡ºé…ç½®çš„ç”¨æˆ·
- éœ€è¦å¤‡ä»½å’Œæ¢å¤é…ç½®çš„ç”¨æˆ·

---

### [è·¯ç”±è¡¨è®¾è®¡](routing-tables.md)
Linux è·¯ç”±è¡¨å’Œä¼˜å…ˆçº§ç³»ç»Ÿçš„è¯¦ç»†è¯´æ˜ã€‚

**æ ¸å¿ƒå†…å®¹**ï¼š
- è·¯ç”±è¡¨æ¶æ„ï¼ˆè¡¨ 5ã€50ã€80ã€mainã€defaultï¼‰
- ä¼˜å…ˆçº§ä½“ç³»ï¼ˆ5ã€10ã€100-899ã€900ã€32766ã€32767ï¼‰
- ä¸´æ—¶æµ‹è¯•è·¯ç”±ï¼ˆä¼˜å…ˆçº§ 5ï¼‰
- ä¿æŠ¤è·¯ç”±ï¼ˆä¼˜å…ˆçº§ 10ï¼‰
- ç”¨æˆ·ç­–ç•¥ç»„ï¼ˆä¼˜å…ˆçº§ 100-899ï¼‰
- é»˜è®¤è·¯ç”±ï¼ˆä¼˜å…ˆçº§ 900ï¼‰

**é€‚ç”¨å¯¹è±¡**ï¼š
- éœ€è¦æ·±å…¥ç†è§£è·¯ç”±è§„åˆ™çš„ç”¨æˆ·
- éœ€è¦æ‰‹åŠ¨è°ƒè¯•è·¯ç”±é—®é¢˜çš„ç”¨æˆ·
- éœ€è¦è®¾è®¡å¤æ‚è·¯ç”±ç­–ç•¥çš„ç”¨æˆ·

**å…³é”®å‘½ä»¤**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰è·¯ç”±è§„åˆ™
ip rule show

# æŸ¥çœ‹ç‰¹å®šè·¯ç”±è¡¨
ip route show table 50

# æµ‹è¯•è·¯ç”±
ip route get 8.8.8.8
```

---

### [ä¿æŠ¤è·¯ç”±æœºåˆ¶](protection-routes.md)
é˜²æ­¢è·¯ç”±ç¯è·¯çš„æ ¸å¿ƒæœºåˆ¶ï¼Œæ·±å…¥è§£é‡Šä¿æŠ¤è·¯ç”±çš„å·¥ä½œåŸç†ã€‚

**æ ¸å¿ƒé—®é¢˜**ï¼š
- ä¸ºä»€ä¹ˆéœ€è¦ä¿æŠ¤è·¯ç”±ï¼Ÿ
- è·¯ç”±ç¯è·¯æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ
- ä¿æŠ¤è·¯ç”±å¦‚ä½•é˜²æ­¢ç¯è·¯ï¼Ÿ

**å…³é”®æœºåˆ¶**ï¼š
- ä¼˜å…ˆçº§ 10 çš„ä¿æŠ¤è·¯ç”±è§„åˆ™
- éš§é“å¯¹ç«¯ IP å¼ºåˆ¶èµ°ä¸»è·¯ç”±è¡¨
- åŠ¨æ€ IP åœºæ™¯ä¸‹çš„ä¿æŠ¤è·¯ç”±åŒæ­¥

**å·¥ä½œæµç¨‹**ï¼š
1. åˆ›å»ºéš§é“æ—¶è‡ªåŠ¨æ·»åŠ ä¿æŠ¤è·¯ç”±
2. åº”ç”¨ç­–ç•¥æ—¶éªŒè¯ä¿æŠ¤è·¯ç”±å­˜åœ¨
3. åŠ¨æ€ IP å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°ä¿æŠ¤è·¯ç”±
4. å®šæ—¶ä»»åŠ¡æ¸…ç†åƒµå°¸è§„åˆ™

**é€‚ç”¨å¯¹è±¡**ï¼š
- é‡åˆ°è·¯ç”±ç¯è·¯é—®é¢˜çš„ç”¨æˆ·
- ä½¿ç”¨åŠ¨æ€ IP å¯¹ç«¯çš„ç”¨æˆ·
- éœ€è¦ç†è§£ç³»ç»Ÿå†…éƒ¨æœºåˆ¶çš„å¼€å‘è€…

---

### [æ•…éšœæ’æŸ¥](troubleshooting.md)
å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆçš„å®Œæ•´æŒ‡å—ã€‚

**æ¶µç›–é—®é¢˜**ï¼š

**éš§é“é—®é¢˜**ï¼š
- Ping ä¸é€šè™šæ‹Ÿ IP
- WireGuard æ¡æ‰‹å¤±è´¥
- GRE éš§é“æ— æ³•å»ºç«‹
- éš§é“é¢‘ç¹æ–­å¼€

**ç­–ç•¥è·¯ç”±é—®é¢˜**ï¼š
- ç­–ç•¥è·¯ç”±ä¸ç”Ÿæ•ˆ
- è·¯ç”±ç¯è·¯
- ä¼˜å…ˆçº§å†²çª
- æµé‡èµ°å‘é”™è¯¯

**è¿é€šæ€§é—®é¢˜**ï¼š
- è¿é€šæ€§æ£€æŸ¥å¤±è´¥
- å»¶è¿Ÿå¼‚å¸¸é«˜
- ä¸¢åŒ…ç‡é«˜
- é—´æ­‡æ€§æ•…éšœ

**æ€§èƒ½é—®é¢˜**ï¼š
- MTU è¿‡å¤§å¯¼è‡´ä¸¢åŒ…
- CPU ä½¿ç”¨ç‡é«˜
- å¸¦å®½å—é™

**é€‚ç”¨å¯¹è±¡**ï¼š
- é‡åˆ°é—®é¢˜éœ€è¦å¿«é€Ÿè§£å†³çš„ç”¨æˆ·
- éœ€è¦ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½çš„ç”¨æˆ·
- éœ€è¦ç†è§£å¸¸è§é™·é˜±çš„æ–°æ‰‹

**æ’æŸ¥å·¥å…·**ï¼š
```bash
# éš§é“çŠ¶æ€æ£€æŸ¥
ip link show <éš§é“å>
wg show <éš§é“å>  # WireGuard
ip xfrm state      # IPsec

# è·¯ç”±æ£€æŸ¥
ip rule show
ip route show table 50
ip route get <ç›®æ ‡IP>

# è¿é€šæ€§æ£€æŸ¥
ping -c 4 <IP>
traceroute <IP>
```

---

## ğŸ” å¿«é€ŸæŸ¥æ‰¾

### æŒ‰é—®é¢˜ç±»å‹

**é…ç½®ç›¸å…³**ï¼š
- [é…ç½®æ–‡ä»¶è¯¦è§£](config-files.md) - é…ç½®æ–‡ä»¶æ ¼å¼å’Œå­—æ®µ
- [æ•…éšœæ’æŸ¥](troubleshooting.md) - é…ç½®é”™è¯¯æ’æŸ¥

**è·¯ç”±ç›¸å…³**ï¼š
- [è·¯ç”±è¡¨è®¾è®¡](routing-tables.md) - è·¯ç”±è§„åˆ™å’Œä¼˜å…ˆçº§
- [ä¿æŠ¤è·¯ç”±æœºåˆ¶](protection-routes.md) - è·¯ç”±ç¯è·¯é˜²æ­¢
- [æ•…éšœæ’æŸ¥](troubleshooting.md) - è·¯ç”±é—®é¢˜æ’æŸ¥

**éš§é“ç›¸å…³**ï¼š
- [é…ç½®æ–‡ä»¶è¯¦è§£](config-files.md) - éš§é“é…ç½®æ ¼å¼
- [æ•…éšœæ’æŸ¥](troubleshooting.md) - éš§é“é—®é¢˜æ’æŸ¥

**æ€§èƒ½ç›¸å…³**ï¼š
- [æ•…éšœæ’æŸ¥](troubleshooting.md) - æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æŒ‰ä½¿ç”¨é˜¶æ®µ

**è§„åˆ’é˜¶æ®µ**ï¼š
- [è·¯ç”±è¡¨è®¾è®¡](routing-tables.md) - ç†è§£è·¯ç”±è¡¨æ¶æ„
- [ä¿æŠ¤è·¯ç”±æœºåˆ¶](protection-routes.md) - ç†è§£ä¿æŠ¤æœºåˆ¶

**é…ç½®é˜¶æ®µ**ï¼š
- [é…ç½®æ–‡ä»¶è¯¦è§£](config-files.md) - äº†è§£é…ç½®æ ¼å¼

**è¿ç»´é˜¶æ®µ**ï¼š
- [æ•…éšœæ’æŸ¥](troubleshooting.md) - è§£å†³æ—¥å¸¸é—®é¢˜

**ä¼˜åŒ–é˜¶æ®µ**ï¼š
- [è·¯ç”±è¡¨è®¾è®¡](routing-tables.md) - ä¼˜åŒ–è·¯ç”±ç­–ç•¥
- [æ•…éšœæ’æŸ¥](troubleshooting.md) - æ€§èƒ½è°ƒä¼˜

## ğŸ“– æ·±åº¦å­¦ä¹ è·¯å¾„

### è·¯å¾„ 1: ç†è§£è·¯ç”±ç³»ç»Ÿ

1. **åŸºç¡€æ¦‚å¿µ**
   - [è·¯ç”±è¡¨è®¾è®¡](routing-tables.md) - äº†è§£è·¯ç”±è¡¨å’Œä¼˜å…ˆçº§

2. **æ ¸å¿ƒæœºåˆ¶**
   - [ä¿æŠ¤è·¯ç”±æœºåˆ¶](protection-routes.md) - ç†è§£ä¿æŠ¤è·¯ç”±çš„å¿…è¦æ€§

3. **å®è·µéªŒè¯**
   - ä½¿ç”¨ `ip rule show` å’Œ `ip route show table 50` æŸ¥çœ‹å®é™…é…ç½®
   - ä½¿ç”¨ `ip route get` æµ‹è¯•è·¯ç”±èµ°å‘

4. **é—®é¢˜æ’æŸ¥**
   - [æ•…éšœæ’æŸ¥](troubleshooting.md) - è·¯ç”±é—®é¢˜éƒ¨åˆ†

### è·¯å¾„ 2: é…ç½®æ–‡ä»¶ç®¡ç†

1. **é…ç½®æ ¼å¼**
   - [é…ç½®æ–‡ä»¶è¯¦è§£](config-files.md) - å­¦ä¹ æ‰€æœ‰é…ç½®æ–‡ä»¶æ ¼å¼

2. **æ‰‹åŠ¨ç¼–è¾‘**
   - ç»ƒä¹ æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶
   - ç†è§£å„å­—æ®µçš„ä½œç”¨

3. **æ‰¹é‡æ“ä½œ**
   - ä½¿ç”¨è„šæœ¬æ‰¹é‡ç”Ÿæˆé…ç½®
   - å¤‡ä»½å’Œæ¢å¤é…ç½®

4. **é—®é¢˜æ’æŸ¥**
   - [æ•…éšœæ’æŸ¥](troubleshooting.md) - é…ç½®é”™è¯¯æ’æŸ¥

### è·¯å¾„ 3: æ•…éšœæ’æŸ¥ä¸“å®¶

1. **å¸¸è§é—®é¢˜**
   - [æ•…éšœæ’æŸ¥](troubleshooting.md) - é˜…è¯»æ‰€æœ‰å¸¸è§é—®é¢˜

2. **æ ¸å¿ƒæœºåˆ¶**
   - [è·¯ç”±è¡¨è®¾è®¡](routing-tables.md) - ç†è§£è·¯ç”±è§„åˆ™
   - [ä¿æŠ¤è·¯ç”±æœºåˆ¶](protection-routes.md) - ç†è§£ä¿æŠ¤è·¯ç”±

3. **è¯Šæ–­å·¥å…·**
   - æŒæ¡ `ip`ã€`wg`ã€`ping`ã€`traceroute` ç­‰å·¥å…·
   - å­¦ä¼šæŸ¥çœ‹æ—¥å¿—å’Œé…ç½®æ–‡ä»¶

4. **å®è·µç»éªŒ**
   - åœ¨æµ‹è¯•ç¯å¢ƒä¸­æ¨¡æ‹Ÿå„ç§æ•…éšœ
   - ç»ƒä¹ ä½¿ç”¨è¯Šæ–­å·¥å…·å¿«é€Ÿå®šä½é—®é¢˜

## ğŸ› ï¸ å¸¸ç”¨è¯Šæ–­å‘½ä»¤

### æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰éš§é“
sudo twnode line list

# æŸ¥çœ‹æ‰€æœ‰ç­–ç•¥ç»„
sudo twnode policy list

# æŸ¥çœ‹è·¯ç”±è§„åˆ™
ip rule show

# æŸ¥çœ‹è·¯ç”±è¡¨
ip route show table main
ip route show table 50
ip route show table 80
```

### éš§é“è¯Šæ–­

```bash
# WireGuard éš§é“
wg show <éš§é“å>
wg show <éš§é“å> endpoints
wg show <éš§é“å> latest-handshakes

# GRE éš§é“
ip link show <éš§é“å>
ip addr show <éš§é“å>

# IPsec
sudo ip xfrm state
sudo ip xfrm policy
```

### è·¯ç”±è¯Šæ–­

```bash
# æµ‹è¯•è·¯ç”±
ip route get 8.8.8.8
ip route get 192.168.100.5

# æŒ‡å®šæºåœ°å€æµ‹è¯•
ip route get 8.8.8.8 from 10.10.1.5

# æŸ¥çœ‹ç‰¹å®šä¼˜å…ˆçº§è§„åˆ™
ip rule show pref 10
ip rule show pref 100
```

### è¿é€šæ€§æµ‹è¯•

```bash
# Ping æµ‹è¯•
ping -c 4 <ç›®æ ‡IP>

# æŒ‡å®šæ¥å£ Ping
ping -I <æ¥å£å> -c 4 <ç›®æ ‡IP>

# è·¯ç”±è·Ÿè¸ª
traceroute <ç›®æ ‡IP>

# TrueWord Node è¿é€šæ€§æ£€æŸ¥
sudo twnode line check <éš§é“å> 8.8.8.8
```

### æ—¥å¿—å’Œé…ç½®

```bash
# æŸ¥çœ‹é…ç½®æ–‡ä»¶
cat /etc/trueword_node/config.yaml
cat /etc/trueword_node/tunnels/<éš§é“å>.yaml
cat /etc/trueword_node/policies/<ç­–ç•¥ç»„å>.json

# æŸ¥çœ‹è¿è¡Œæ—¶æ•°æ®
cat /var/lib/trueword_node/check_results.json
cat /var/lib/trueword_node/peer_configs/<éš§é“å>.txt

# æŸ¥çœ‹æ’¤é”€å‘½ä»¤
cat /var/lib/trueword_node/rev/<éš§é“å>.rev

# ç³»ç»Ÿæ—¥å¿—ï¼ˆå¦‚æœæœ‰ï¼‰
journalctl -u twnode -n 100
dmesg | grep -i wireguard
dmesg | grep -i gre
```

## ğŸ”— ç›¸å…³èµ„æº

### å‘½ä»¤å‚è€ƒ
- [line å‘½ä»¤](../commands/line/index.md) - éš§é“ç®¡ç†å‘½ä»¤è¯¦è§£
- [policy å‘½ä»¤](../commands/policy/index.md) - ç­–ç•¥è·¯ç”±å‘½ä»¤è¯¦è§£

### æ•™ç¨‹
- [WireGuard é…ç½®](../tutorials/wireguard-setup.md) - å®Œæ•´çš„ WireGuard é…ç½®æ•™ç¨‹
- [GRE over IPsec é…ç½®](../tutorials/gre-ipsec-setup.md) - GRE éš§é“é…ç½®æ•™ç¨‹
- [ç­–ç•¥è·¯ç”±å®è·µ](../tutorials/policy-routing.md) - ç­–ç•¥è·¯ç”±å®æˆ˜æ¡ˆä¾‹
- [æ•…éšœè½¬ç§»é…ç½®](../tutorials/failover-setup.md) - é«˜å¯ç”¨æ¶æ„é…ç½®
- [åŠ¨æ€ IP å¤„ç†](../tutorials/dynamic-ip.md) - åŠ¨æ€ IP åœºæ™¯é…ç½®
- [å¤šå±‚éš§é“åµŒå¥—](../tutorials/nested-tunnels.md) - åµŒå¥—éš§é“é…ç½®

### åŸºç¡€æ–‡æ¡£
- [å¿«é€Ÿå…¥é—¨](../getting-started.md) - 5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
- [æ¶æ„è®¾è®¡](../architecture.md) - æ ¸å¿ƒè®¾è®¡ç†å¿µ

## ğŸ’¡ æç¤º

- é‡åˆ°é—®é¢˜æ—¶ï¼Œå…ˆæŸ¥çœ‹ [æ•…éšœæ’æŸ¥](troubleshooting.md) çš„å¸¸è§é—®é¢˜éƒ¨åˆ†
- ç†è§£ [è·¯ç”±è¡¨è®¾è®¡](routing-tables.md) å’Œ [ä¿æŠ¤è·¯ç”±æœºåˆ¶](protection-routes.md) æœ‰åŠ©äºå¿«é€Ÿå®šä½è·¯ç”±é—®é¢˜
- ä½¿ç”¨ `ip rule show` å’Œ `ip route show table X` æ˜¯è¯Šæ–­è·¯ç”±é—®é¢˜çš„å…³é”®
- é…ç½®æ–‡ä»¶å¤‡ä»½å¾ˆé‡è¦ï¼Œå®šæœŸå¤‡ä»½ `/etc/trueword_node/` ç›®å½•

---

**å¯¼èˆª**: [è¿”å›é¦–é¡µ](../index.md) | [å‘½ä»¤å‚è€ƒ](../commands/index.md) | [æ•™ç¨‹](../tutorials/index.md)
